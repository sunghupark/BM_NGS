###[trimming] -> 다음에는 파일명에 ChIP-Seq 대신 ChIP_Seq으로 쓸 것. -> 파일명은 심플할 수록 좋은듯 
(venv) (base) bm@BM:/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/rawdata$
/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/Tools/TrimGalore-0.6.10/trim_galore -j 4 -o /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/ --fastqc_arg "-4 --outdir /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/Fastqc/" Drosha_ChIP-seq.SRR5017445.fastq.gz ;
/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/Tools/TrimGalore-0.6.10/trim_galore -j 4 -o /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/ --fastqc_arg "-4 --outdir /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/Fastqc/" Drosha_Input_ChIP-seq.SRR5017448.fastq.gz ; 
/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/Tools/TrimGalore-0.6.10/trim_galore -j 4 -o /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/ --fastqc_arg "-4 --outdir /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/Fastqc/" MLL2_ChIP-seq.SRR941117.fastq.gz ;
/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/Tools/TrimGalore-0.6.10/trim_galore -j 4 -o /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/ --fastqc_arg "-4 --outdir /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/Fastqc/" MLL2_ChIP-seq.SRR941118.fastq.gz ; 
/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/Tools/TrimGalore-0.6.10/trim_galore -j 4 -o /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/ --fastqc_arg "-4 --outdir /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/Fastqc/" MLL2_ChIP-seq.SRR941119.fastq.gz ;
/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/Tools/TrimGalore-0.6.10/trim_galore -j 4 -o /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/ --fastqc_arg "-4 --outdir /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/Fastqc/" MLL2_Input_ChIP-seq.SRR941120.fastq.gz ; 
/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/Tools/TrimGalore-0.6.10/trim_galore -j 4 -o /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/ --fastqc_arg "-4 --outdir /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/Fastqc/" MLL2_Input_ChIP-seq.SRR941121.fastq.gz ; 
/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/Tools/TrimGalore-0.6.10/trim_galore -j 4 -o /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/ --fastqc_arg "-4 --outdir /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/Fastqc/" MLL2_Input_ChIP-seq.SRR941122.fastq.gz

###[bowtie2]아무 디렉토리에서. 아무 디렉토리에서가 아니라 trimmed에서 돌리자.
bowtie2 -p 2 --very-sensitive -x /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/indexes/mm9/mm9 -X 1000 -U /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/Drosha_ChIP-seq.SRR5017445_trimmed.fq.gz -S Drosha_ChIP-seq.SRR5017445_trimmed.sam ; 
bowtie2 -p 2 --very-sensitive -x /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/indexes/mm9/mm9 -X 1000 -U /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/Drosha_Input_ChIP-seq.SRR5017448_trimmed.fq.gz -S Drosha_Input_ChIP-seq.SRR5017448_trimmed.sam ; 
bowtie2 -p 2 --very-sensitive -x /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/indexes/mm9/mm9 -X 1000 -U /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/MLL2_ChIP-seq.SRR941117_trimmed.fq.gz -S MLL2_ChIP-seq.SRR941117_trimmed.sam ; 
bowtie2 -p 2 --very-sensitive -x /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/indexes/mm9/mm9 -X 1000 -U /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/MLL2_ChIP-seq.SRR941118_trimmed.fq.gz -S MLL2_ChIP-seq.SRR941118_trimmed.sam ; 
bowtie2 -p 2 --very-sensitive -x /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/indexes/mm9/mm9 -X 1000 -U /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/MLL2_ChIP-seq.SRR941119_trimmed.fq.gz -S MLL2_ChIP-seq.SRR941119_trimmed.sam ;
bowtie2 -p 2 --very-sensitive -x /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/indexes/mm9/mm9 -X 1000 -U /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/MLL2_Input_ChIP-seq.SRR941120_trimmed.fq.gz -S MLL2_Input_ChIP-seq.SRR941120_trimmed.sam ; 
bowtie2 -p 2 --very-sensitive -x /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/indexes/mm9/mm9 -X 1000 -U /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/MLL2_Input_ChIP-seq.SRR941121_trimmed.fq.gz -S MLL2_Input_ChIP-seq.SRR941121_trimmed.sam ; 
bowtie2 -p 2 --very-sensitive -x /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/indexes/mm9/mm9 -X 1000 -U /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/MLL2_Input_ChIP-seq.SRR941122_trimmed.fq.gz -S MLL2_Input_ChIP-seq.SRR941122_trimmed.sam

###[samtools view]->samtools가 chip-seq에서 -을 못알아먹어서 언더바로 바꿈. : "rename 's/ChIP-seq/ChIP_Seq/' /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/*ChIP-seq*" 사용함.
-> 060223 > 추가하는 것으로 수정함(fail to read header라고 떴었음).
samtools view -@ 2 -S -bh -q 10 -F 1804 - Drosha_ChIP_seq.SRR5017445_trimmed.sam Drosha_ChIP_seq.SRR5017445_trimmed.bam ;
samtools view -@ 2 -S -bh -q 10 -F 1804 - Drosha_Input_ChIP_seq.SRR5017448_trimmed.sam Drosha_Input_ChIP_seq.SRR5017448_trimmed.bam ;
samtools view -@ 2 -S -bh -q 10 -F 1804 - MLL2_ChIP_seq.SRR941117_trimmed.sam MLL2_ChIP_seq.SRR941117_trimmed.bam ;
samtools view -@ 2 -S -bh -q 10 -F 1804 - MLL2_ChIP_seq.SRR941118_trimmed.sam MLL2_ChIP_seq.SRR941118_trimmed.bam ;
samtools view -@ 2 -S -bh -q 10 -F 1804 - MLL2_ChIP_seq.SRR941119_trimmed.sam MLL2_ChIP_seq.SRR941119_trimmed.bam ;
samtools view -@ 2 -S -bh -q 10 -F 1804 - MLL2_Input_ChIP_seq.SRR941120_trimmed.sam MLL2_Input_ChIP_seq.SRR941120_trimmed.bam ;
samtools view -@ 2 -S -bh -q 10 -F 1804 - MLL2_Input_ChIP_seq.SRR941121_trimmed.sam MLL2_Input_ChIP_seq.SRR941121_trimmed.bam ;
samtools view -@ 2 -S -bh -q 10 -F 1804 - MLL2_Input_ChIP_seq.SRR941122_trimmed.sam MLL2_Input_ChIP_seq.SRR941122_trimmed.bam
-> chat의 도움으로 samtools_view.sh라는 코드를 만듦.

###[samtools sort]
samtools sort -@ 2 -m 24G -o /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/aligned/Drosha_ChIP-seq.SRR5017445_trimmed_sorted.bam /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/Drosha_ChIP_seq.SRR5017445_trimmed.bam ;
samtools sort -@ 2 -m 24G -o /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/aligned/Drosha_Input_ChIP-seq.SRR5017448_trimmed_sorted.bam /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/Drosha_Input_ChIP_seq.SRR5017448_trimmed.bam ;
samtools sort -@ 2 -m 24G -o /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/aligned/MLL2_ChIP-seq.SRR941117_trimmed_sorted.bam /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/MLL2_ChIP_seq.SRR941117_trimmed.bam ;
samtools sort -@ 2 -m 24G -o /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/aligned/MLL2_ChIP-seq.SRR941118_trimmed_sorted.bam /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/MLL2_ChIP_seq.SRR941118_trimmed.bam ;
samtools sort -@ 2 -m 24G -o /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/aligned/MLL2_ChIP-seq.SRR941119_trimmed_sorted.bam /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/MLL2_ChIP_seq.SRR941119_trimmed.bam ;
samtools sort -@ 2 -m 24G -o /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/aligned/MLL2_Input_ChIP-seq.SRR941120_trimmed_sorted.bam /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/MLL2_Input_ChIP_seq.SRR941120_trimmed.bam ;
samtools sort -@ 2 -m 24G -o /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/aligned/MLL2_Input_ChIP-seq.SRR941121_trimmed_sorted.bam /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/MLL2_Input_ChIP_seq.SRR941121_trimmed.bam ;
samtools sort -@ 2 -m 24G -o /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/aligned/MLL2_Input_ChIP-seq.SRR941122_trimmed_sorted.bam /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/trimmed/MLL2_Input_ChIP_seq.SRR941122_trimmed.bam
-> chat의 도움으로 samtools_sort.sh라는 코드를 만듦.

###[picard] mll2_drosha_colocal/duprm이라는 디렉토리를 만들고 비었는지 확인하고 돌릴 것.
java -jar /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/Tools/picard.jar MarkDuplicates I=/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/aligned/Drosha_ChIP_seq.SRR5017445_trimmed_sorted.bam O=/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/Drosha_ChIP_seq.SRR5017445_trimmed_duprm.bam M=/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/Drosha_ChIP_seq.SRR5017445_trimmed_marked_dup_metrics.txt ;
java -jar /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/Tools/picard.jar MarkDuplicates I=/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/aligned/Drosha_Input_ChIP_seq.SRR5017448_trimmed_sorted.bam O=/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/Drosha_Input_ChIP_seq.SRR5017448_trimmed_duprm.bam M=/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/Drosha_Input_ChIP_seq.SRR5017448_trimmed_marked_dup_metrics.txt ;
java -jar /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/Tools/picard.jar MarkDuplicates I=/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/aligned/MLL2_ChIP_seq.SRR941117_trimmed_sorted.bam O=/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_ChIP_seq.SRR941117_trimmed_duprm.bam M=/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_ChIP_seq.SRR941117_trimmed_marked_dup_metrics.txt ; 
java -jar /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/Tools/picard.jar MarkDuplicates I=/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/aligned/MLL2_ChIP_seq.SRR941118_trimmed_sorted.bam O=/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_ChIP_seq.SRR941118_trimmed_duprm.bam M=/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_ChIP_seq.SRR941118_trimmed_marked_dup_metrics.txt ;
java -jar /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/Tools/picard.jar MarkDuplicates I=/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/aligned/MLL2_ChIP_seq.SRR941119_trimmed_sorted.bam O=/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_ChIP_seq.SRR941119_trimmed_duprm.bam M=/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_ChIP_seq.SRR941119_trimmed_marked_dup_metrics.txt ;
java -jar /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/Tools/picard.jar MarkDuplicates I=/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/aligned/MLL2_Input_ChIP_seq.SRR941120_trimmed_sorted.bam O=/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_Input_ChIP_seq.SRR941120_trimmed_duprm.bam M=/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_Input_ChIP_seq.SRR941120_trimmed_marked_dup_metrics.txt ;
java -jar /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/Tools/picard.jar MarkDuplicates I=/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/aligned/MLL2_Input_ChIP_seq.SRR941121_trimmed_sorted.bam O=/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_Input_ChIP_seq.SRR941121_trimmed_duprm.bam M=/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_Input_ChIP_seq.SRR941121_trimmed_marked_dup_metrics.txt ;
java -jar /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/Tools/picard.jar MarkDuplicates I=/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/aligned/MLL2_Input_ChIP_seq.SRR941122_trimmed_sorted.bam O=/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_Input_ChIP_seq.SRR941122_trimmed_duprm.bam M=/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_Input_ChIP_seq.SRR941122_trimmed_marked_dup_metrics.txt
-> chat의 도움을 받음, nano mark_duplicates.sh라고 치고 시작, chmod -x mark_duplicates.sh까지 써야댐. 실행은 ./mark_duplicates.sh로.

#(중요)-> 이유는 모르겠는데 sorted_duprm.bam이 다 대문자 Seq이라고 되어있었음... 이유는 모르겠음...
samtools view -h -@ 2 /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/Drosha_ChIP_seq.SRR5017445_trimmed_duprm.bam | egrep -v chrM | samtools view -bh -@ 2 - | bedtools intersect -abam stdin -b /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/blacklist/mm9-blacklist.bed.gz -v > /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/Drosha_ChIP_seq.SRR5017445_trimmed_duprm_rmChrM_rmBlack.bam ;
samtools view -h -@ 2 /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/Drosha_Input_ChIP_seq.SRR5017448_trimmed_duprm.bam | egrep -v chrM | samtools view -bh -@ 2 - | bedtools intersect -abam stdin -b /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/blacklist/mm9-blacklist.bed.gz -v > /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/Drosha_Input_ChIP_seq.SRR5017448_trimmed.duprm_rmChrM_rmBlack.bam ;
samtools view -h -@ 2 /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_ChIP_seq.SRR941117_trimmed_duprm.bam | egrep -v chrM | samtools view -bh -@ 2 - | bedtools intersect -abam stdin -b /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/blacklist/mm9-blacklist.bed.gz -v > /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_ChIP_seq.SRR941117_trimmed.duprm_rmChrM_rmBlack.bam ;
samtools view -h -@ 2 /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_ChIP_seq.SRR941118_trimmed_duprm.bam | egrep -v chrM | samtools view -bh -@ 2 - | bedtools intersect -abam stdin -b /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/blacklist/mm9-blacklist.bed.gz -v > /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_ChIP_seq.SRR941118_trimmed.duprm_rmChrM_rmBlack.bam ;
samtools view -h -@ 2 /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_ChIP_seq.SRR941119_trimmed_duprm.bam | egrep -v chrM | samtools view -bh -@ 2 - | bedtools intersect -abam stdin -b /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/blacklist/mm9-blacklist.bed.gz -v > /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_ChIP_seq.SRR941119_trimmed.duprm_rmChrM_rmBlack.bam ;
samtools view -h -@ 2 /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_Input_ChIP_seq.SRR941120_trimmed_duprm.bam | egrep -v chrM | samtools view -bh -@ 2 - | bedtools intersect -abam stdin -b /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/blacklist/mm9-blacklist.bed.gz -v > /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_Input_ChIP_seq.SRR941120_trimmed.duprm_rmChrM_rmBlack.bam ;
samtools view -h -@ 2 /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_Input_ChIP_seq.SRR941121_trimmed_duprm.bam | egrep -v chrM | samtools view -bh -@ 2 - | bedtools intersect -abam stdin -b /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/blacklist/mm9-blacklist.bed.gz -v > /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_Input_ChIP_seq.SRR941121_trimmed.duprm_rmChrM_rmBlack.bam ;
samtools view -h -@ 2 /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_Input_ChIP_seq.SRR941122_trimmed_duprm.bam | egrep -v chrM | samtools view -bh -@ 2 - | bedtools intersect -abam stdin -b /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/blacklist/mm9-blacklist.bed.gz -v > /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_Input_ChIP_seq.SRR941122_trimmed.duprm_rmChrM_rmBlack.bam

#-> 이건 그냥 바로 넣음
rm /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/Drosha_ChIP_Seq.SRR5017445_trimmed_sorted_duprm.bam ;
rm /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/Drosha_Input_ChIP_Seq.SRR5017448_trimmed_sorted_duprm.bam ;
rm /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_ChIP_Seq.SRR941117_trimmed_sorted_duprm.bam ;
rm /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_ChIP_Seq.SRR941118_trimmed_sorted_duprm.bam ;
rm /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_ChIP_Seq.SRR941119_trimmed_sorted_duprm.bam ;
rm /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_Input_ChIP_Seq.SRR941120_trimmed_sorted_duprm.bam ;
rm /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_Input_ChIP_Seq.SRR941121_trimmed_sorted_duprm.bam ;
rm /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_Input_ChIP_Seq.SRR941122_trimmed_sorted_duprm.bam

###[macs3]-> 그냥 바로 넣음 duprm 파일에서. -B : BedGraph가 .bdg로 나옴.
macs3 callpeak -t /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/Drosha_ChIP_Seq.SRR5017445_trimmed_sorted_duprm_rmChrM_rmBlack.bam -c /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/Drosha_Input_ChIP_Seq.SRR5017448_trimmed_sorted_duprm_rmChrM_rmBlack.bam -f BAM -g mm -n DROSHA -B -q 0.05;
macs3 callpeak -t /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_ChIP_Seq.SRR941117_trimmed_sorted_duprm_rmChrM_rmBlack.bam /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_ChIP_Seq.SRR941118_trimmed_sorted_duprm_rmChrM_rmBlack.bam /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_ChIP_Seq.SRR941119_trimmed_sorted_duprm_rmChrM_rmBlack.bam -c /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_Input_ChIP_Seq.SRR941120_trimmed_sorted_duprm_rmChrM_rmBlack.bam /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_Input_ChIP_Seq.SRR941121_trimmed_sorted_duprm_rmChrM_rmBlack.bam /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_Input_ChIP_Seq.SRR941122_trimmed_sorted_duprm_rmChrM_rmBlack.bam -f BAM -g mm -n MLL2 -B -q 0.05 

###[bedtools intersect라고 구글에 치면 나옴]-> homer 대신 사용함 // 나오면 "cat MLL2_DROSHA_merge.bed | wc -l" 으로 피크 수 확인하기.
bedtools intersect -a DROSHA_summits.bed \
-b MLL2_summits.bed \
-f 0.50 -r > MLL2_DROSHA_merge.bed

###[bedGraphToBigWig]-> bdg는 파일이 macs3에서 두개가 나오는데 그냥 각각 bigwig으로 바꾸고, intersect 볼때는 treat만 보면 될 것 같다.
/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/Tools/bedGraphToBigWig /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/DROSHA_treat_pileup.bdg /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/chromsizes/mm9.chrom.sizes /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/DROSHA_treat_pileup.bw ; \
/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/Tools/bedGraphToBigWig /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/DROSHA_control_lambda.bdg /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/chromsizes/mm9.chrom.sizes /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/DROSHA_control_lambda.bw ; \
/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/Tools/bedGraphToBigWig /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_treat_pileup.bdg /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/chromsizes/mm9.chrom.sizes /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_treat_pileup.bw ; \
/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/Tools/bedGraphToBigWig /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_control_lambda.bdg /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/chromsizes/mm9.chrom.sizes /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_control_lambda.bw

###[Homer - motif analysis] 하나당 30분 이상. 052523 연구노트 참조.
#MLL2<-directory 설정을 잘못함.
/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/Tools/HOMER/bin/findMotifsGenome.pl /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_summits.bed mm9 /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_col
#Drosha
/media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/Tools/HOMER/bin/findMotifsGenome.pl /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/duprm/MLL2_summits.bed mm9 /media/bm/790240e4-2887-451f-ad02-1b19c4b4e120/PSH/mll2_drosha_colocal/homermotifresult/mll2_homermotifresult










